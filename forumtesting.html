<!DOCTYPE html>
<html>
<head>
<style>
body {background-color: powderblue;}
h1   {color: blue;}
p    {color: red;}
p {
  border: 2px solid powderblue;
  margin: 50px
  padding: 30px;
} 
</style>
</head>
mysql> create table forum_topics (
    -> topic_id int not null primary key auto_increment,
    -> topic_title varchar (150),
    -> topic_create_time datetime,
    -> topic_owner varchar (150)
    -> );
Query OK, 0 rows affected (0.03 sec)

mysql> create table forum_posts (
    -> post_id int not null primary key auto_increment,
    -> topic_id int not null,
    -> post_text text,
    -> post_create_time datetime,
    -> post_owner varchar (150)
    -> );
Query OK, 0 rows affected (0.00 sec)
 <html>
   <head>
   <title>Add a Topic</title>
   </head>
   <body>
   <h1>Add a Topic</h1>
   <form method=post action="do_addtopic.php">
   <p><strong>Your E-Mail Address:</strong><br>
  <input type="text" name="topic_owner" size=40 maxlength=150>
  <p><strong>Topic Title:</strong><br>
  <input type="text" name="topic_title" size=40 maxlength=150>
  <P><strong>Post Text:</strong><br>
  <textarea name="post_text" rows=8 cols=40 wrap=virtual></textarea>
  <P><input type="submit" name="submit" value="Add Topic"></p>
  </form>
  </body>
  </html>  
  <?php
   //check for required fields from the form
   if ((!$_POST[topic_owner]) || (!$_POST[topic_title])
       || (!$_POST[post_text])) {
       header("Location: addtopic.html");
       exit;
   }
   
  $conn = mysql_connect("localhost", "joeuser", "somepass")
      or die(mysql_error());
  mysql_select_db("testDB",$conn) or die(mysql_error());
  
  //create and issue the first query
  $add_topic = "insert into forum_topics values ('', '$_POST[topic_title]',
      now(), '$_POST[topic_owner]')";
  mysql_query($add_topic,$conn) or die(mysql_error());
  
  $topic_id = mysql_insert_id();
  
  $add_post = "insert into forum_posts values ('', '$topic_id',
      '$_POST[post_text]', now(), '$_POST[topic_owner]')";
  mysql_query($add_post,$conn) or die(mysql_error());
  
  $msg = "<P>The <strong>$topic_title</strong> topic has been created.</p>";
  ?>
  <html>
  <head>
  <title>New Topic Added</title>
  </head>
  <body>
  <h1>New Topic Added</h1>
  <?php print $msg; ?>
  </body>
  </html>
  <?php
   //connect to server and select database
   $conn = mysql_connect("localhost", "joeuser", "somepass")
       or die(mysql_error());
   mysql_select_db("testDB",$conn) or die(mysql_error());
   
   //gather the topics
   $get_topics = "select topic_id, topic_title,
   date_format(topic_create_time, '%b %e %Y at %r') as fmt_topic_create_time,
  topic_owner from forum_topics order by topic_create_time desc";
  $get_topics_res = mysql_query($get_topics,$conn) or die(mysql_error());
  if (mysql_num_rows($get_topics_res) < 1) {
     $display_block = "<P><em>No topics exist.</em></p>";
  } else {
     $display_block = "
     <table cellpadding=3 cellspacing=1 border=1>
     <tr>
     <th>TOPIC TITLE</th>
     <th># of POSTS</th>
     </tr>";
  
      while ($topic_info = mysql_fetch_array($get_topics_res)) {
         $topic_id = $topic_info['topic_id'];
         $topic_title = stripslashes($topic_info['topic_title']);
         $topic_create_time = $topic_info['fmt_topic_create_time'];
         $topic_owner = stripslashes($topic_info['topic_owner']);
  
         $get_num_posts = "select count(post_id) from forum_posts
              where topic_id = $topic_id";
         $get_num_posts_res = mysql_query($get_num_posts,$conn)
              or die(mysql_error());
         $num_posts = mysql_result($get_num_posts_res,0,'count(post_id)');
  
         $display_block .= "
         <tr>
         <td><a href=\"showtopic.php?topic_id=$topic_id\">
         <strong>$topic_title</strong></a><br>
         Created on $topic_create_time by $topic_owner</td>
         <td align=center>$num_posts</td>
         </tr>";
     }
  
     $display_block .= "</table>";
  }
  ?>
  <html>
  <head>
  <title>Topics in My Forum</title>
  </head>
  <body>
  <h1>Topics in My Forum</h1>
  <?php print $display_block; ?>
  <P>Would you like to <a href="addtopic.html">add a topic</a>?</p>
  </body>
  </html>
  <?php
   if (!$_GET[topic_id]) {
      header("Location: topiclist.php");
      exit;
   }
   
  $conn = mysql_connect("localhost", "joeuser", "somepass")
      or die(mysql_error());
  mysql_select_db("testDB",$conn) or die(mysql_error());
  
  $verify_topic = "select topic_title from forum_topics where
      topic_id = $_GET[topic_id]";
  $verify_topic_res = mysql_query($verify_topic, $conn)
      or die(mysql_error());
 
  if (mysql_num_rows($verify_topic_res) < 1) {
      //this topic does not exist
     $display_block = "<P><em>You have selected an invalid topic.
      Please <a href=\"topiclist.php\">try again</a>.</em></p>";
  } else {
     $topic_title = stripslashes(mysql_result($verify_topic_res,0,
          'topic_title'));
  
     $get_posts = "select post_id, post_text, date_format(post_create_time,
          '%b %e %Y at %r') as fmt_post_create_time, post_owner from
          forum_posts where topic_id = $_GET[topic_id]
          order by post_create_time asc";
  
     $get_posts_res = mysql_query($get_posts,$conn) or die(mysql_error());
  
     //create the display string
     $display_block = "
     <P>Showing posts for the <strong>$topic_title</strong> topic:</p>
 
     <table width=100% cellpadding=3 cellspacing=1 border=1>
     <tr>
     <th>AUTHOR</th>
     <th>POST</th>
     </tr>";
  
     while ($posts_info = mysql_fetch_array($get_posts_res)) {
         $post_id = $posts_info['post_id'];
         $post_text = nl2br(stripslashes($posts_info['post_text']));
         $post_create_time = $posts_info['fmt_post_create_time'];
         $post_owner = stripslashes($posts_info['post_owner']);
  
         //add to display
         $display_block .= "
         <tr>
         <td width=35% valign=top>$post_owner<br>[$post_create_time]</td>
         <td width=65% valign=top>$post_text<br><br>
          <a href=\"replytopost.php?post_id=$post_id\"><strong>REPLY TO
          POST</strong></a></td>
         </tr>";
     }
  
     //close up the table
     $display_block .= "</table>";
  }
  ?>
  <html>
  <head>
  <title>Posts in Topic</title>
  </head>
  <body>
  <h1>Posts in Topic</h1>
  <?php print $display_block; ?>
  </body>
  </html>
  
<body>
<span><header style="background-color:#70f0ff;border:2px solid Tomato;font-family:Comic Sans MS,Comic Sans,cursive;color:#ff0004"> this is stupid </header></span>
<span><nav style="background-color:#70f0ff;border:2px solid Tomato;font-family:Comic Sans MS,Comic Sans,cursive;color:#ff0004"><div class="topnav">
  <a class="active" href="./index.html">Home</a>
  <a href="./forumtesting.html">forumtesting</a>
  <a href="./1.html">Start</a>
  <a href="./about.html">About</a>
</div></nav></span>  
<h1>testingn</h1>
<p> t e s t i n g </p>
</body>
</html>
